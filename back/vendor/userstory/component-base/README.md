## Базовый компонент

### Контроллер

От него обычно наследуются все контроллеры в проекте. Позволяет задавать через конфиг view и layout для каждого действия, предоставляет
дефолтную реализацию crud, позволяет включать только определенные экшены для crud через `$defaultActions`, установить дефолтный экшен для
редиректа после сохранения через `$defaultRedirect`.

### Model views

Предоставляет базовые классы для обработчиков данных перед их передачей во view. Model views должны наследоваться
от `Userstory\ComponentBase\ModelView\AbstractModelView` и реализовыватьинтерфейс `ModelViewInterface`. Для вызова у ModelView соответствующих
методов для дефолтных экшенов в контроллерах подключается `Userstory\ComponentBase\traits\MethodByActionTrait`.
 
### Models

Для удобной работы со связями предоставлен класс `Userstory\ComponentBase\entities\RelationActiveRecord`, который позволяет работать
со связями как с обычными элементами, валидировать и сохранять модель вместе со всеми связанными данными. Для использования следует при
наследовании переопределить атрибут `$definedRelation`.
Для автоматического изменения даты и автора создания\обновления\удаления записи можно подключить `Userstory\ComponentBase\traits\ModifierAwareTrait`.
Для загрузки и сохранения файлов можно подключить трейт `Userstory\ComponentBase\traits\UploadFileTrait`. В атрибуте `$entityFiles` перечисляются
поля для сохранения имен файлов, а для использования трейта в моделях, связанных с основной, у них заполняется атрибут `$attachmentFiles`. В таком
случае у основной модели должна быть связть `attachments`.

### Трейты

Трейт `Userstory\ComponentBase\traits\ManageAuthTrait` создан для использования в миграциях и позволяет создавать\удалять роли с заданными разрешениями.
Для задания роли необходимо определить атрибуты `$roleName` и `$permissions` с именем роли и списком разрешений, соответственно.

Список методов:
- `getAuthManager` - получение экземпляра `Userstory\ModuleUser\components\AuthenticationComponent`
- `insertRole($config)` - создает роль c заданной конфигурацией
- `removeRole($config)` - удаляет роль
- `getRoleId()` - возвращает ID роли
- `insertAuth()` - добавляет разрешения для роли
- `removeAuth()` - удаляет разрешения для роли

### Порождение объектов при помощи фабрик

[Подробнее тут](/docs/Factory.md)

### Расширение ActiveQuery

[Подробнее тут](/docs/ActiveQueryTrait.md)

### Расширение AbstractCache

[Подробнее тут](/docs/AbstractCache.md)

### Форматтер XmlResponseFormatter

Данный форматтер расширяет базовый функционал Yii и позволяет добавлять данные в XML-атрибуты ответа в формате XML.
Для добавления атрибутов в XML в ответе должен содержаться ключ "@attributes". При нахождении этого ключа в родительский XML будут добавлены атрибуты.
Значения атрибутов должны быть представленны в массиве, при этом как ключ, так и значение должны быть типа string. При несоблюдении этих условий атрибут будет игнорироваться.

Пример правильно оформленного ответа:

[
    'errors' => [],
    'notice' => [],
    'data'   => [
        'document' => [
            '@attributes' => [
                'attr1' => 'attrValue1',
                'attr2' => 'attrValue2',
                ...
                'attrN' => 'attrValueN',
            ],
            'xmlBody' => [
                ...
            ],
        ],
    ],
]
