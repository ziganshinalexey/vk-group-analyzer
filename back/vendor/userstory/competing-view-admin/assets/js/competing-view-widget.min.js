!function(t){var e=function(e,i){if(this.$element=t(e),this.$note=t('<div class="alert"></div>'),this.options=t.extend(!0,{},t.fn.notify.defaults,i),this.options.transition?"fade"==this.options.transition?this.$note.addClass("in").addClass(this.options.transition):this.$note.addClass(this.options.transition):this.$note.addClass("fade").addClass("in"),this.options.type?this.$note.addClass("alert-"+this.options.type):this.$note.addClass("alert-success"),this.options.message||""===this.$element.data("message")?"object"==typeof this.options.message?this.options.message.html?this.$note.html(this.options.message.html):this.options.message.text&&this.$note.text(this.options.message.text):this.$note.html(this.options.message):this.$note.html(this.$element.data("message")),this.options.closable){var s=t('<a class="close pull-right" href="#">&times;</a>');t(s).on("click",t.proxy(n,this)),this.$note.prepend(s)}return this},n=function(){return this.options.onClose(),t(this.$note).remove(),this.options.onClosed(),!1};e.prototype.show=function(){this.options.fadeOut.enabled&&this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",t.proxy(n,this)),this.$element.append(this.$note),this.$note.alert()},e.prototype.hide=function(){this.options.fadeOut.enabled?this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",t.proxy(n,this)):n.call(this)},t.fn.notify=function(t){return new e(this,t)},t.fn.notify.defaults={type:"success",closable:!0,transition:"fade",fadeOut:{enabled:!0,delay:3e3},message:null,onClose:function(){},onClosed:function(){}}}(window.jQuery);var compentingViewModule=function(t){var e=[],n=[],i=null,s="",o={$container:null,once:!1,urls:[],sendTimeout:null,sendInterval:null,notty:null,$nottyElement:null,promise:t.when(),needUpdate:!1,nottyUpdateOpts:function(){return{type:"warning",closable:!1,fadeOut:{enabled:!1},message:{html:this.html()}}},prepareData:function(t){var e={fullName:t.username};return e},addToData:function(t,i){e.push(this.prepareData(i)),n.push(parseInt(t,10))},onThen:function(i){if(t.isArray(i))return!1;var s=[];t.each(i,function(t){s.push(parseInt(t,10))}),t.each(i,function(e,i){-1===t.inArray(parseInt(e,10),n)&&(this.addToData(e,i),this.needUpdate=!0)}.bind(this));var o=0===t(s).not(n).length,a=0===t(n).not(s).length,h=n.length===s.length;o&&a&&h||(this.needUpdate=!0,n=s,e=[],t.each(i,function(t,n){e.push(this.prepareData(n))}.bind(this)))},html:function(){var n=['<span class="glyphicon glyphicon-eye-open"></span>','<div class="notty-body">'];return t.each(e,function(t,e){n.push(e.fullName+"<br>")}),n.push("</div>"),n.join("")},reBuildData:function(){t.each(e,function(t,n){n.hasOwnProperty("last")&&delete n.last,1+t==e.length&&(n.last=!0)}.bind(this))},update:function(){this.$nottyElement=this.$container.find(".bottom-right"),this.notty=this.$nottyElement.notify(this.nottyUpdateOpts()),this.notty.show(),this.notty.$element.children().length>1&&this.notty.$element.children().eq(0).remove()},generateContainer:function(){this.once||(t("body").append(['<div class="competing-view-widget">','<div class="notifications bottom-right"></div>',"</div>"].join("")),this.once=!0,this.$container=t(".competing-view-widget"))},send:function(){t.each(this.urls,function(e,n){this.promise=this.promise.then(function(){return t.ajax(n)}).then(this.onThen.bind(this))}.bind(this)),this.promise.then(function(){this.needUpdate&&(this.reBuildData(),this.update(),this.needUpdate=!1)}.bind(this))},FIRST_REQUIEST_DELAY:150,init:function(){this.generateContainer(),clearInterval(this.sendInterval),clearTimeout(this.sendTimeout),this.sendTimeout=setTimeout(this.send.bind(this),this.FIRST_REQUIEST_DELAY),this.sendInterval=setInterval(this.send.bind(this),i)}};return{addView:function(t){var e=s+"?entityName="+t.entity+"&entityId="+t.id;o.urls.push(e),o.init()},setParams:function(e){e=t.extend({viewDelay:5e3},e),i=(""+e.viewDelay).length<4?250*parseInt(e.viewDelay,10):e.viewDelay,s=e.viewUrl}}}(jQuery);